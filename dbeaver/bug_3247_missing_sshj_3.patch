From 482f81bff7930ec4d7358f561063b05992e56b7d Mon Sep 17 00:00:00 2001
From: serge-rider <serge@jkiss.org>
Date: Thu, 5 Apr 2018 00:26:07 +0300
Subject: [PATCH] #3247 SSHJ and BC repackaging

---
 .../org.jkiss.dbeaver.net.sshj.feature/feature.xml  | 11 ++---------
 .../META-INF/MANIFEST.MF                            |  2 +-
 product/localRepository/pom.xml                     | 21 ++-------------------
 3 files changed, 5 insertions(+), 29 deletions(-)

diff --git a/features/org.jkiss.dbeaver.net.sshj.feature/feature.xml b/features/org.jkiss.dbeaver.net.sshj.feature/feature.xml
index dc5cc6a8b6..b2ba135ca3 100644
--- a/features/org.jkiss.dbeaver.net.sshj.feature/feature.xml
+++ b/features/org.jkiss.dbeaver.net.sshj.feature/feature.xml
@@ -22,14 +22,7 @@
    </requires>
 
    <plugin id="org.jkiss.dbeaver.net.ssh.sshj" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
-
-   <!-- SSHJ and dependencies -->
-   <plugin id="com.hierynomus.sshj" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
-   <plugin id="com.jcraft.jzlib" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
-   <plugin id="net.i2p.crypto.eddsa" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
-
-   <!--Bounce Castle bundles-->
-   <plugin id="bcprov" download-size="0" install-size="0" version="1.59" unpack="false"/>
-   <plugin id="bcpkix" download-size="0" install-size="0" version="1.59" unpack="false"/>
+   <plugin id="org.jkiss.bundle.bouncycastle" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
+   <plugin id="org.jkiss.bundle.sshj" download-size="0" install-size="0" version="0.0.0" unpack="false"/>
 
 </feature>
diff --git a/plugins/org.jkiss.dbeaver.net.ssh.sshj/META-INF/MANIFEST.MF b/plugins/org.jkiss.dbeaver.net.ssh.sshj/META-INF/MANIFEST.MF
index b17befa4f0..75f72312cd 100644
--- a/plugins/org.jkiss.dbeaver.net.ssh.sshj/META-INF/MANIFEST.MF
+++ b/plugins/org.jkiss.dbeaver.net.ssh.sshj/META-INF/MANIFEST.MF
@@ -10,5 +10,5 @@ Bundle-ActivationPolicy: lazy
 Bundle-ClassPath: .
 Require-Bundle: org.jkiss.dbeaver.model,
  org.jkiss.dbeaver.net.ssh,
- com.hierynomus.sshj
+ org.jkiss.bundle.sshj
 Bundle-Localization: OSGI-INF/l10n/bundle
diff --git a/product/localRepository/pom.xml b/product/localRepository/pom.xml
index 049e80d7f4..b32cfd78e5 100644
--- a/product/localRepository/pom.xml
+++ b/product/localRepository/pom.xml
@@ -48,25 +48,8 @@
 								<artifact><id>org.apache.xmlbeans:xmlbeans:2.6.0</id></artifact>
 
 								<!-- SSH and BouncyCastle -->
-								<artifact><id>org.bouncycastle:bcprov-jdk15on:1.59</id></artifact>
-								<artifact><id>org.bouncycastle:bcpkix-jdk15on:1.59</id></artifact>
-								<artifact><id>com.hierynomus:sshj:0.23.0</id>
-									<excludes>
-										<exclude>org.bouncycastle:*</exclude>
-									</excludes>
-								</artifact>
-								<artifact><id>com.jcraft:jzlib:1.1.3</id></artifact>
-								<artifact><id>net.i2p.crypto:eddsa:0.2.0</id>
-									<override>true</override>
-									<instructions>
-										<Bundle-Name>EdDSA-Java</Bundle-Name>
-										<Bundle-Description>Implementation of EdDSA in Java</Bundle-Description>
-										<Bundle-License>https://creativecommons.org/publicdomain/zero/1.0/</Bundle-License>
-
-										<Created-By>Apache Maven Bundle Plugin</Created-By>
-										<Export-Package>*</Export-Package>
-									</instructions>
-								</artifact>
+								<artifact><id>org.jkiss.bundle:org.jkiss.bundle.sshj:0.23.0</id></artifact>
+								<artifact><id>org.jkiss.bundle:org.jkiss.bundle.bouncycastle:1.59.0</id></artifact>
 
 								<!-- Batik -->
 								<artifact><id>org.jkiss.bundle:org.jkiss.bundle.apache.batik:1.9.1</id></artifact>
